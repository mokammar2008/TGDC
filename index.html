<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GameForge Studio - Premium Game Development</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-bg: #0a0a0a;
            --secondary-bg: #1a1a1a;
            --accent-bg: #2a2a2a;
            --text-primary: #ffffff;
            --text-secondary: #cccccc;
            --accent-color: #ffffff;      /* White for dark mode */
            --danger-color: #ff4444;
            --border-color: #333333;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --hover-accent: #c9c9c9;      /* White for dark mode */
        }

        [data-theme="light"] {
            --primary-bg: #ffffff;
            --secondary-bg: #f8f9fa;
            --accent-bg: #e9ecef;
            --text-primary: #000000;
            --text-secondary: #333333;
            --accent-color: #000000;      /* Black for light mode */
            --danger-color: #dc3545;
            --border-color: #dee2e6;
            --hover-accent: #404040;      /* Black for light mode */
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--primary-bg);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            transition: var(--transition);
        }

        /* Enhanced Navbar Styles */
        .navbar {
            position: fixed;
            top: 0;
            width: 100%;
            background: rgba(0, 0, 0, 0.92);
            backdrop-filter: blur(12px);
            z-index: 1000;
            padding: 0.7rem 0;
            box-shadow: 0 2px 16px 0 rgba(0,0,0,0.12);
            transition: var(--transition);
        }

        [data-theme="light"] .navbar {
            background: rgba(255, 255, 255, 0.92);
            box-shadow: 0 2px 16px 0 rgba(0,0,0,0.06);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 2rem;
            min-height: 60px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.7rem;
            font-size: 2rem;
            font-weight: bold;
            letter-spacing: 1px;
            user-select: none;
        }

        .logo img {
            height: 44px;
            width: auto;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            background: transparent;
            transition: box-shadow 0.2s;
        }
        .logo img:hover {
            box-shadow: 0 4px 16px rgba(0,0,0,0.18);
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 2.2rem;
            align-items: center;
        }

        .nav-links li {
            position: relative;
        }

        .nav-links a {
            color: var(--text-primary);
            text-decoration: none;
            font-size: 1.08rem;
            font-weight: 500;
            letter-spacing: 0.5px;
            padding: 0.3rem 0.7rem;
            border-radius: 6px;
            transition: background 0.2s, color 0.2s;
            position: relative;
            z-index: 1;
        }

        .nav-links a::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 2.5px;
            background: var(--accent-color);
            border-radius: 2px;
            transition: width 0.3s cubic-bezier(0.4,0,0.2,1), background 0.2s;
        }

        .nav-links a:hover,
        .nav-links a.active {
            background: rgba(255,255,255,0.06);
            color: var(--accent-color);
        }

        .nav-links a:hover::after,
        .nav-links a.active::after {
            width: 80%;
            background: var(--accent-color);
        }

        /* Disable hover and underline for Home when active */
        .nav-links a.active.no-hover,
        .nav-links a.active.no-hover:hover {
            background: none !important;
            color: var(--accent-color) !important;
            cursor: default;
        }
        .nav-links a.active.no-hover::after {
            width: 0 !important;
            background: none !important;
        }

        .theme-toggle {
            background: none;
            border: 1.5px solid var(--border-color);
            color: var(--text-primary);
            padding: 0.5rem;
            border-radius: 50%;
            cursor: pointer;
            margin-left: 1.2rem;
            font-size: 1.25rem;
            display: flex;
            align-items: center;
            transition: background 0.2s, color 0.2s, border 0.2s;
        }

        .theme-toggle:hover {
            background: var(--hover-accent);
            color: var(--primary-bg);
            border-color: var(--accent-color);
        }

        .hamburger {
            display: none;
            flex-direction: column;
            cursor: pointer;
            margin-left: 1.2rem;
            z-index: 1001;
        }

        .hamburger span {
            width: 28px;
            height: 3.5px;
            background: var(--text-primary);
            margin: 4px 0;
            border-radius: 2px;
            transition: var(--transition);
        }

        /* Hero Section */
        .hero {
            height: 100vh;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .hero-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #1a1a1a, #2a2a2a);
            opacity: 0;
            transition: opacity 1s ease-in-out;
        }

        .hero-bg.active {
            opacity: 1;
        }

        .hero-bg:nth-child(1) {
            background: linear-gradient(45deg, #667eea, #764ba2);
        }

        .hero-bg:nth-child(2) {
            background: linear-gradient(45deg, #f093fb, #f5576c);
        }

        .hero-bg:nth-child(3) {
            background: linear-gradient(45deg, #4facfe, #00f2fe);
        }

        .hero-content {
            text-align: center;
            z-index: 2;
            max-width: 800px;
            padding: 0 2rem;
        }

        .hero-title {
            font-size: 4rem;
            font-weight: bold;
            margin-bottom: 1rem;
            opacity: 0;
            transform: translateY(50px);
            animation: fadeInUp 1s ease-out 0.5s forwards;
        }

        .hero-subtitle {
            font-size: 1.5rem;
            margin-bottom: 2rem;
            opacity: 0;
            transform: translateY(30px);
            animation: fadeInUp 1s ease-out 1s forwards;
        }

        .cta-button {
            background: var(--accent-color);
            color: var(--primary-bg);
            padding: 1rem 2rem;
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: var(--transition);
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 1s ease-out 1.5s forwards;
        }

        .cta-button:hover {
            background: var(--hover-accent);
            color: var(--primary-bg);
            box-shadow: 0 10px 30px rgba(255,255,255,0.1);
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Section Styles */
        .section {
            padding: 5rem 0;
            max-width: 1200px;
            margin: 0 auto;
        }

        .section-title {
            font-size: 3rem;
            text-align: center;
            margin-bottom: 3rem;
            background: linear-gradient(45deg, var(--accent-color), var(--accent-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .about-content {
            text-align: center;
            font-size: 1.2rem;
            max-width: 800px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        /* Games Grid */
        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            padding: 0 2rem;
        }

        .game-card {
            background: var(--secondary-bg);
            border-radius: 15px;
            overflow: hidden;
            transition: var(--transition);
            border: 1px solid var(--border-color);
        }

        .game-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .game-image {
            width: 100%;
            height: 200px;
            background: linear-gradient(45deg, var(--accent-color), var(--accent-color));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            color: white;
        }

        .game-info {
            padding: 1.5rem;
        }

        .game-title {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .game-description {
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        .game-rating {
            display: flex;
            gap: 0.2rem;
            margin-bottom: 1rem;
        }

        .star {
            color: #ffd700;
        }

        .download-btn {
            background: var(--accent-color);
            color: var(--primary-bg);
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: var(--transition);
            width: 100%;
        }

        .download-btn:hover {
            background: var(--hover-accent);
            color: var(--primary-bg);
        }

        /* Contact Section */
        .contact {
            background: var(--secondary-bg);
            padding: 5rem 0;
        }

        .contact-content {
            max-width: 800px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .social-links {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .social-links a {
            color: var(--text-primary);
            font-size: 2rem;
            transition: var(--transition);
        }

        .social-links a:hover {
            color: var(--hover-accent);
        }

        .contact-form {
            display: grid;
            gap: 1rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            margin-bottom: 0.5rem;
            font-weight: bold;
        }

        .form-group input,
        .form-group textarea {
            padding: 1rem;
            border: 1px solid var(--border-color);
            border-radius: 10px;
            background: var(--primary-bg);
            color: var(--text-primary);
            transition: var(--transition);
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--accent-color);
        }

        .submit-btn {
            background: var(--accent-color);
            color: var(--primary-bg);
            padding: 1rem;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: var(--transition);
            font-size: 1.1rem;
        }

        .submit-btn:hover {
            background: var(--hover-accent);
            color: var(--primary-bg);
        }

        /* Admin Dashboard */
        .admin-panel {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            z-index: 2000;
            overflow-y: auto;
            padding: 2rem;
        }

        [data-theme="light"] .admin-panel {
            background: rgba(255, 255, 255, 0.95);
        }

        .admin-content {
            background: var(--primary-bg);
            margin: 0 auto;
            padding: 2rem;
            border-radius: 15px;
            max-width: 900px;
            position: relative;
            border: 1px solid var(--border-color);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        [data-theme="light"] .admin-content {
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
        }

        .close-admin {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: var(--danger-color);
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .close-admin:hover {
            background: #cc0000;
            transform: scale(1.1);
        }

        .admin-form {
            display: grid;
            gap: 1rem;
            margin-bottom: 2rem;
            padding: 1rem;
            background: var(--secondary-bg);
            border-radius: 10px;
            border: 1px solid var(--border-color);
        }

        .admin-games-list {
            max-height: 500px;
            overflow-y: auto;
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 1rem;
            background: var(--secondary-bg);
        }

        .admin-game-item {
            background: var(--primary-bg);
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            border: 1px solid var(--border-color);
            transition: var(--transition);
        }

        .admin-game-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .admin-game-info {
            flex: 1;
            margin-right: 1rem;
        }

        .admin-game-info h4 {
            color: var(--accent-color);
            margin-bottom: 0.5rem;
            font-size: 1.2rem;
        }

        .admin-game-info p {
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .admin-game-rating {
            color: #ffd700;
            font-size: 1.1rem;
        }

        .admin-buttons {
            display: flex;
            gap: 0.5rem;
            flex-direction: column;
        }

        .edit-btn, .delete-btn {
            padding: 0.8rem 1.2rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: bold;
            min-width: 80px;
        }

        .edit-btn {
            background: var(--accent-color);
            color: var(--primary-bg);
        }

        .edit-btn:hover {
            background: var(--hover-accent);
            color: var(--primary-bg);
            transform: scale(1.05);
        }

        .delete-btn {
            background: var(--danger-color);
            color: white;
        }

        .delete-btn:hover {
            background: #cc0000;
            transform: scale(1.05);
        }

        .form-status {
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            text-align: center;
            font-weight: bold;
        }

        .form-status.success {
            background: rgba(0, 255, 136, 0.1);
            color: var(--accent-color);
            border: 1px solid var(--accent-color);
        }

        .form-status.error {
            background: rgba(255, 68, 68, 0.1);
            color: var(--danger-color);
            border: 1px solid var(--danger-color);
        }

        /* Loading Spinner */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--accent-color);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive Design */
        @media (max-width: 900px) {
            .nav-container {
                padding: 0 1rem;
            }
            .nav-links {
                gap: 1.2rem;
            }
        }

        @media (max-width: 768px) {
            .nav-links {
                position: fixed;
                top: 70px;
                left: -100%;
                width: 100%;
                height: calc(100vh - 70px);
                background: var(--primary-bg);
                flex-direction: column;
                justify-content: center;
                align-items: center;
                gap: 2.5rem;
                transition: left 0.3s cubic-bezier(0.4,0,0.2,1);
                box-shadow: 0 8px 32px rgba(0,0,0,0.18);
            }
            .nav-links.active {
                left: 0;
            }
            .hamburger {
                display: flex;
            }
            .logo img {
                height: 36px;
            }
        }
    </style>
</head>
<body data-theme="dark">
    <!-- Navbar -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <img id="site-logo" src="https://github.com/mokammar2008/TGDC/blob/main/LOGO-white.png" alt="GameForge Logo">
            </div>
            <ul class="nav-links">
                <li><a href="#home" class="active">Home</a></li>
                <li><a href="#about">About</a></li>
                <li><a href="#shop">Shop</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
            <button class="theme-toggle" onclick="toggleTheme()">
                <i class="fas fa-moon" id="theme-icon"></i>
            </button>
            <div class="hamburger" onclick="toggleMenu()">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="home" class="hero">
        <div class="hero-bg active"></div>
        <div class="hero-bg"></div>
        <div class="hero-bg"></div>
        <div class="hero-content">
            <h1 class="hero-title">TGDC</h1>
            <p class="hero-subtitle">Tunisian Game Development Company</p>
            <button class="cta-button" onclick="scrollToSection('shop')">Explore Our Games</button>
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="section">
        <h2 class="section-title">About Us</h2>
        <div class="about-content">
            <p>At TGDC, we are proud pioneers in the Tunisian game development scene. Founded by passionate developers, artists, and storytellers, our mission is to build immersive gaming experiences that resonate with players around the world.</p>
            <br>
            <p>With a focus on creativity, innovation, and cultural storytelling, TGDC blends cutting-edge technology with rich artistic vision to deliver original games that push boundaries and spark imagination.</p>
            <br>
            <p>From indie prototypes to full-scale commercial releases, our studio thrives on collaboration, experimentation, and excellence. Whether you're a casual gamer or a hardcore fan, our projects aim to entertain, inspire, and connect.</p>
          </div>
    </section>

    <!-- Shop Section -->
    <section id="shop" class="section">
        <h2 class="section-title">Our Games</h2>
        <div class="games-grid" id="games-container">
            <!-- Games will be loaded here dynamically -->
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="contact">
        <div class="contact-content">
            <h2 class="section-title">Get In Touch</h2>
            <div class="social-links">
                <a href="#" title="Discord"><i class="fab fa-discord"></i></a>
                <a href="#" title="Instagram"><i class="fab fa-instagram"></i></a>
                <a href="https://www.youtube.com/@TGDC" title="YouTube"><i class="fab fa-youtube"></i></a>
                <a href="#" title="Twitter"><i class="fab fa-twitter"></i></a>
            </div>
            <form class="contact-form" onsubmit="submitContactForm(event)">
                <div class="form-group">
                    <label for="name">Name</label>
                    <input type="text" id="name" name="name" required>
                </div>
                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" name="email" required>
                </div>
                <div class="form-group">
                    <label for="message">Message</label>
                    <textarea id="message" name="message" rows="5" required></textarea>
                </div>
                <button type="submit" class="submit-btn">Send Message</button>
            </form>
        </div>
    </section>

    <!-- Admin Panel -->
    <div class="admin-panel" id="admin-panel">
        <div class="admin-content">
            <button class="close-admin" onclick="toggleAdmin()">&times;</button>
            <h2 class="section-title">Admin Dashboard</h2>
            
            <form class="admin-form" onsubmit="addGame(event)">
                <div class="form-group">
                    <label for="game-name"><i class="fas fa-gamepad"></i> Game Name</label>
                    <input type="text" id="game-name" placeholder="Enter game name" required>
                </div>
                <div class="form-group">
                    <label for="game-description"><i class="fas fa-align-left"></i> Description</label>
                    <textarea id="game-description" rows="3" placeholder="Enter game description" required></textarea>
                </div>
                <div class="form-group">
                    <label for="game-rating"><i class="fas fa-star"></i> Rating (1-5)</label>
                    <input type="number" id="game-rating" min="1" max="5" value="5" required>
                </div>
                <div class="form-group">
                    <label for="game-download"><i class="fas fa-download"></i> Download Link</label>
                    <input type="url" id="game-download" placeholder="https://example.com/game-download" required>
                </div>
                <button type="submit" class="submit-btn">
                    <i class="fas fa-plus"></i> Add Game
                </button>
            </form>

            <div class="admin-games-list" id="admin-games-list">
                <!-- Admin games list will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
    
    <!-- EmailJS -->
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>

    <script>
        // Use the same Firebase config as in your admin.html
        const firebaseConfig = {
            apiKey: "AIzaSyDY4MyORHidlow_0HgKgMeVfMpjA1oErg8",
            authDomain: "crud-8e803.firebaseapp.com",
            projectId: "crud-8e803",
            storageBucket: "crud-8e803.appspot.com",
            messagingSenderId: "521706284207",
            appId: "1:521706284207:web:d57b9487153f53afa3605a"
        };

        // Initialize Firebase
        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }
        const db = firebase.firestore();

        // EmailJS Configuration (Replace with your config)
        emailjs.init("hZ-7DKfUXcVuNg6EH"); // <-- Replace with your actual EmailJS public key

        // Contact Form
        function submitContactForm(event) {
            event.preventDefault();
            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            const message = document.getElementById('message').value;
            const submitBtn = event.target.querySelector('.submit-btn');
            const originalText = submitBtn.textContent;
            submitBtn.innerHTML = '<div class="loading"></div> Sending...';
            submitBtn.disabled = true;

            // Replace these with your actual EmailJS service ID and template ID
            const serviceID = 'service_zqa163i';
            const templateID = 'template_hjcmszl';

            emailjs.send(serviceID, templateID, {
                from_name: name,
                from_email: email,
                message: message
            }).then(() => {
                alert('Message sent successfully!');
                document.querySelector('.contact-form').reset();
            }).catch((error) => {
                console.error('Error sending message:', error);
                alert('Error sending message. Please try again.');
            }).finally(() => {
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
            });
        }

        // Theme Toggle
        function toggleTheme() {
            const body = document.body;
            const themeIcon = document.getElementById('theme-icon');
            const navbar = document.querySelector('.navbar');
            const logoImg = document.getElementById('site-logo');

            if (body.getAttribute('data-theme') === 'dark') {
                body.setAttribute('data-theme', 'light');
                themeIcon.className = 'fas fa-sun';
                localStorage.setItem('theme', 'light');
                logoImg.src = 'assets/LOGO-dark.png'; // <-- your light mode logo
            } else {
                body.setAttribute('data-theme', 'dark');
                themeIcon.className = 'fas fa-moon';
                localStorage.setItem('theme', 'dark');
                logoImg.src = 'assets/LOGO-white.png'; // <-- your dark mode logo
            }
            updateNavbarBackground();
        }

        function initializeTheme() {
            const savedTheme = localStorage.getItem('theme') || 'dark';
            const body = document.body;
            const themeIcon = document.getElementById('theme-icon');
            const logoImg = document.getElementById('site-logo');
            body.setAttribute('data-theme', savedTheme);
            themeIcon.className = savedTheme === 'light' ? 'fas fa-sun' : 'fas fa-moon';
            logoImg.src = savedTheme === 'light' ? 'assets/LOGO-dark.png' : 'assets/LOGO-white.png';
        }

        function updateNavbarBackground() {
            const navbar = document.querySelector('.navbar');
            const isDark = document.body.getAttribute('data-theme') === 'dark';
            if (window.scrollY > 100) {
                navbar.style.background = isDark 
                    ? 'rgba(0, 0, 0, 0.95)' 
                    : 'rgba(255, 255, 255, 0.95)';
            } else {
                navbar.style.background = isDark 
                    ? 'rgba(0, 0, 0, 0.9)' 
                    : 'rgba(255, 255, 255, 0.9)';
            }
        }

        function toggleMenu() {
            const navLinks = document.querySelector('.nav-links');
            navLinks.classList.toggle('active');
        }

        function scrollToSection(sectionId) {
            document.getElementById(sectionId).scrollIntoView({
                behavior: 'smooth'
            });
        }

        // Hero Background Slider
        let currentBg = 0;
        const backgrounds = document.querySelectorAll('.hero-bg');
        function nextBackground() {
            backgrounds[currentBg].classList.remove('active');
            currentBg = (currentBg + 1) % backgrounds.length;
            backgrounds[currentBg].classList.add('active');
        }
        setInterval(nextBackground, 5000);

        // Load Games from Firebase
        function loadGames() {
            const gamesContainer = document.getElementById('games-container');
            gamesContainer.innerHTML = '<div class="loading"></div>';
            db.collection('games').get().then((querySnapshot) => {
                gamesContainer.innerHTML = '';
                querySnapshot.forEach((doc) => {
                    const game = doc.data();
                    game.id = doc.id;
                    createGameCard(game, gamesContainer);
                });
            }).catch((error) => {
                console.error("Error loading games: ", error);
                gamesContainer.innerHTML = '<p>Error loading games. Please try again later.</p>';
            });
        }

        function createGameCard(game, container) {
            const gameCard = document.createElement('div');
            gameCard.className = 'game-card';
            const stars = '★'.repeat(game.rating) + '☆'.repeat(5 - game.rating);
            gameCard.innerHTML = `
                <div class="game-image">
                    ${
                        game.imageUrl
                            ? `<img src="${game.imageUrl}" alt="${game.name}" style="width:100%;height:200px;object-fit:cover;border-radius:12px;">`
                            : `<i class="fas fa-gamepad"></i>`
                    }
                </div>
                <div class="game-info">
                    <h3 class="game-title">${game.name}</h3>
                    <p class="game-description">${game.description}</p>
                    <div class="game-rating">
                        ${stars.split('').map(star => `<span class="star">${star}</span>`).join('')}
                    </div>
                    <button class="download-btn" onclick="window.open('${game.downloadLink}', '_blank')">
                        <i class="fas fa-download"></i> Download
                    </button>
                </div>
            `;
            container.appendChild(gameCard);
        }

        // Admin Functions
        let editingGameId = null;

        function toggleAdmin() {
            const adminPanel = document.getElementById('admin-panel');
            const isVisible = adminPanel.style.display === 'block';
            if (isVisible) {
                adminPanel.style.display = 'none';
                resetAdminForm();
            } else {
                adminPanel.style.display = 'block';
                loadAdminGames();
            }
        }

        function showStatus(message, type = 'success') {
            const existingStatus = document.querySelector('.form-status');
            if (existingStatus) existingStatus.remove();
            const statusDiv = document.createElement('div');
            statusDiv.className = `form-status ${type}`;
            statusDiv.textContent = message;
            const adminForm = document.querySelector('.admin-form');
            adminForm.insertBefore(statusDiv, adminForm.firstChild);
            setTimeout(() => { statusDiv.remove(); }, 3000);
        }

        function addGame(event) {
            event.preventDefault();
            const name = document.getElementById('game-name').value.trim();
            const description = document.getElementById('game-description').value.trim();
            const rating = parseInt(document.getElementById('game-rating').value);
            const downloadLink = document.getElementById('game-download').value.trim();
            if (!name || !description || !downloadLink) {
                showStatus('Please fill in all fields', 'error');
                return;
            }
            const gameData = {
                name,
                description,
                rating,
                downloadLink,
                createdAt: new Date()
            };
            if (editingGameId) {
                gameData.updatedAt = new Date();
                db.collection('games').doc(editingGameId).update(gameData)
                    .then(() => {
                        showStatus('Game updated successfully!');
                        resetAdminForm();
                        loadGames();
                        loadAdminGames();
                    })
                    .catch((error) => {
                        console.error("Error updating game: ", error);
                        showStatus('Error updating game. Please try again.', 'error');
                    });
            } else {
                db.collection('games').add(gameData)
                    .then(() => {
                        showStatus('Game added successfully!');
                        document.querySelector('.admin-form').reset();
                        loadGames();
                        loadAdminGames();
                    })
                    .catch((error) => {
                        console.error("Error adding game: ", error);
                        showStatus('Error adding game. Please try again.', 'error');
                    });
            }
        }

        function loadAdminGames() {
            const adminGamesList = document.getElementById('admin-games-list');
            adminGamesList.innerHTML = '<div style="text-align: center; padding: 2rem;"><div class="loading"></div><p>Loading games...</p></div>';
            db.collection('games').orderBy('createdAt', 'desc').get()
                .then((querySnapshot) => {
                    adminGamesList.innerHTML = '';
                    if (querySnapshot.empty) {
                        adminGamesList.innerHTML = '<p style="text-align: center; color: var(--text-secondary); padding: 2rem;">No games found. Add your first game!</p>';
                        return;
                    }
                    querySnapshot.forEach((doc) => {
                        const game = doc.data();
                        const gameItem = document.createElement('div');
                        gameItem.className = 'admin-game-item';
                        // Improved download link UI
                        let displayLink = game.downloadLink.replace(/^https?:\/\//, '').split(/[/?#]/)[0];
                        gameItem.innerHTML = `
                            <div class="admin-game-info">
                                <h4>${game.name}</h4>
                                <p>${game.description}</p>
                                <div class="admin-game-rating">
                                    ${'★'.repeat(game.rating)}${'☆'.repeat(5 - game.rating)} (${game.rating}/5)
                                </div>
                                <small style="color: var(--text-secondary);">
                                    Download: 
                                    <a href="${game.downloadLink}" target="_blank" style="color: var(--accent-color); text-decoration: underline; font-weight: 500; word-break: break-all;">
                                        ${displayLink} <i class="fas fa-external-link-alt" style="font-size:0.9em"></i>
                                    </a>
                                </small>
                            </div>
                            <div class="admin-buttons">
                                <button class="edit-btn" onclick="editGame('${doc.id}', '${game.name.replace(/'/g, "\\'")}', '${game.description.replace(/'/g, "\\'")}', ${game.rating}, '${game.downloadLink}')">
                                    <i class="fas fa-edit"></i> Edit
                                </button>
                                <button class="delete-btn" onclick="deleteGame('${doc.id}', '${game.name.replace(/'/g, "\\'")}')">
                                    <i class="fas fa-trash"></i> Delete
                                </button>
                            </div>
                        `;
                        adminGamesList.appendChild(gameItem);
                    });
                })
                .catch((error) => {
                    console.error("Error loading admin games: ", error);
                    adminGamesList.innerHTML = '<p style="text-align: center; color: var(--danger-color); padding: 2rem;">Error loading games. Please try again.</p>';
                });
        }

        function editGame(id, name, description, rating, downloadLink) {
            editingGameId = id;
            document.getElementById('game-name').value = name;
            document.getElementById('game-description').value = description;
            document.getElementById('game-rating').value = rating;
            document.getElementById('game-download').value = downloadLink;
            const submitBtn = document.querySelector('.admin-form .submit-btn');
            submitBtn.innerHTML = '<i class="fas fa-save"></i> Update Game';
            submitBtn.style.background = '#ff9500';
            document.querySelector('.admin-form').scrollIntoView({ behavior: 'smooth' });
            showStatus('Editing mode activated. Click "Update Game" to save changes.', 'success');
        }

        function deleteGame(id, name) {
            if (confirm(`Are you sure you want to delete "${name}"? This action cannot be undone.`)) {
                db.collection('games').doc(id).delete()
                    .then(() => {
                        showStatus(`"${name}" deleted successfully!`);
                        loadGames();
                        loadAdminGames();
                    })
                    .catch((error) => {
                        console.error("Error deleting game: ", error);
                        showStatus('Error deleting game. Please try again.', 'error');
                    });
            }
        }

        function resetAdminForm() {
            editingGameId = null;
            const form = document.querySelector('.admin-form');
            form.reset();
            const submitBtn = form.querySelector('.submit-btn');
            submitBtn.innerHTML = '<i class="fas fa-plus"></i> Add Game';
            submitBtn.style.background = 'var(--accent-color)';
            const existingStatus = document.querySelector('.form-status');
            if (existingStatus) existingStatus.remove();
        }

        // Smooth scroll for navigation links and manage Home hover
        document.querySelectorAll('.nav-links a').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href').substring(1);
                scrollToSection(targetId);
                document.querySelector('.nav-links').classList.remove('active');
                // Remove .active and .no-hover from all links
                document.querySelectorAll('.nav-links a').forEach(l => {
                    l.classList.remove('active', 'no-hover');
                });
                // Set active to clicked link
                this.classList.add('active');
                // If not Home, disable Home hover/underline
                if (targetId !== 'home') {
                    document.querySelector('.nav-links a[href="#home"]').classList.add('no-hover');
                }
            });
        });

        // On page load, ensure Home is active and no-hover is not set
        document.addEventListener('DOMContentLoaded', function() {
            initializeTheme();
            loadGames();
            setInterval(loadGames, 30000);
            document.querySelectorAll('.nav-links a').forEach(l => {
                l.classList.remove('no-hover');
            });
        });

        // Load games on page load and auto-refresh every 30 seconds
        document.addEventListener('DOMContentLoaded', function() {
            initializeTheme();
            loadGames();
            // setTimeout(() => {
            //     addDemoGamesIfEmpty();
            // }, 2000);

            // Auto-refresh games every 30 seconds
            setInterval(loadGames, 30000);
        });

        // Navbar scroll effect
        window.addEventListener('scroll', updateNavbarBackground);

        // Add demo games if database is empty
        function addDemoGamesIfEmpty() {
            const demoGames = [
                {
                    name: "Cyber Quest",
                    description: "An epic cyberpunk adventure in a neon-lit world filled with mysteries and action.",
                    rating: 5,
                    downloadLink: "https://example.com/cyber-quest"
                },
                {
                    name: "Fantasy Realms",
                    description: "Explore magical kingdoms and battle mythical creatures in this immersive RPG.",
                    rating: 4,
                    downloadLink: "https://example.com/fantasy-realms"
                },
                {
                    name: "Space Odyssey",
                    description: "Navigate through the cosmos in this thrilling space adventure with stunning visuals.",
                    rating: 5,
                    downloadLink: "https://example.com/space-odyssey"
                },
                {
                    name: "Racing Thunder",
                    description: "High-speed racing action with customizable cars and dynamic weather systems.",
                    rating: 4,
                    downloadLink: "https://example.com/racing-thunder"
                }
            ];
            try {
                db.collection('games').limit(1).get().then((querySnapshot) => {
                    if (querySnapshot.empty) {
                        console.log('Adding demo games...');
                        demoGames.forEach((game, index) => {
                            setTimeout(() => {
                                db.collection('games').add({
                                    ...game,
                                    createdAt: new Date(Date.now() + index * 1000)
                            }).catch(console.error);
                        }, index * 500);
                    });
                    setTimeout(() => {
                        loadGames();
                    }, 3000);
                    }
                }).catch((error) => {
                    console.log('Firebase not configured, using demo data display');
                    displayDemoGames(demoGames);
                });
            } catch (error) {
                console.log('Firebase not available, displaying demo games');
                displayDemoGames(demoGames);
            }
        }

        function displayDemoGames(demoGames) {
            const gamesContainer = document.getElementById('games-container');
            gamesContainer.innerHTML = '';
            demoGames.forEach(game => {
                createGameCard(game, gamesContainer);
            });
            const adminBtn = document.querySelector('button[onclick="toggleAdmin()"]');
            if (adminBtn) {
                adminBtn.style.display = 'none';
            }
        }
    </script>

    <footer style="border: none; border-top: 1.5px solid #888; background: var(--secondary-bg); color: var(--text-secondary); text-align: center; padding: 1.2rem 0 0.7rem 0; font-size: 1rem; margin-top: 0;">
        &copy; 2025 TGDC (Tunisian Game Development Company). All rights reserved.
    </footer>
    
</body>

</html>
